package application.RESTController;

import application.entities.Product;
import application.entities.ProductDTO;
import application.entities.UploadForm;
import application.repo.CategoryRepository;
import application.repo.ProductRepository;
import org.apache.commons.codec.binary.StringUtils;
import org.apache.tomcat.util.codec.binary.Base64;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import javax.ws.rs.Path;
import java.io.File;
import java.io.IOException;
import java.util.Random;


@RestController
public class ProductsRESTController {

    /**
     * Siia pange upload kausta tee
     */
    private static String uploadFolder = System.getProperty("user.dir") +
            File.separator+"src"+
            File.separator+ "main"+
            File.separator+ "resources"+
            File.separator+"static"+
            File.separator+"img"+
            File.separator+"upload"+File.separator;
    {
        if (System.getProperty("os.name").contains("Linux")
            || System.getProperty("os.name").contains("Ubuntu")) {
            uploadFolder = "/app/src/main/resources/static/img/upload/";
        }
    }
    private Long randomLong() {
        return Math.abs(new Random().nextLong());
    }

    private final static String NO_IMAGE = "data:image/png;base64,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\n";

    @Autowired
    private ProductRepository productRepository;


    @PostMapping("products/add/save")
    public ProductDTO postProduct(@RequestBody ProductDTO productDTO) {

        System.out.println(productDTO.getImage());
        if (productDTO.getImage().equals("None")) {
            productDTO.setImage(NO_IMAGE);
        } else {
            System.out.println(productDTO.getImage());
            productDTO.setImage(productDTO.getImage());
        }
        System.out.println(productDTO);
        productRepository.addProduct(randomLong(), productDTO.getName(), productDTO.getCategoryId(), productDTO.getTag(),
                productDTO.getDescription(), productDTO.getImage(), productDTO.getPrice(),
                productDTO.getAmount());

        return productDTO;
    }


    @PostMapping("products/add/image/save")
    public String postImage(@ModelAttribute UploadForm form) throws IOException {

        if (form.getFile().isEmpty()) {
            System.out.println("None");
            return "None";
        }
        StringBuilder sb = new StringBuilder();
        if (form.getFile().getOriginalFilename().toLowerCase().contains(".jpeg")){
            sb.append("data:image/jpeg;base64,");
        } else {
            sb.append("data:image/png;base64,");
        }
        sb.append(StringUtils.newStringUtf8(Base64.encodeBase64(form.getFile().getBytes(),false)));
        return sb.toString();
    }

    @PostMapping("products/change/{id}/update")
    public String changeProductPost(@PathVariable("id") String id, @RequestBody ProductDTO productDTO){
        Product checkProduct = productRepository.getById(id);
        // Getting updated fields
        String name = productDTO.getName();
        Long categoryId = productDTO.getCategoryId();
        String description = productDTO.getDescription();
        String image = productDTO.getImage();
        double price = productDTO.getPrice();
        int amount = productDTO.getAmount();
        //Checking if some of them are empty.
        //If yes, we will use existing info about product in DB
        if (name.equals("")){
            name = checkProduct.getName();
        }
        if (categoryId == null){
            categoryId = checkProduct.getCategoryId();
        }
        if (description.equals("")){
            description = checkProduct.getDescription();
        }
        if (image.equals("")){
            image = checkProduct.getImage();
        }
        if (price == 0.0){
            price = checkProduct.getPrice();
        }
        if (amount == 0){
            amount = checkProduct.getAmount();
        }
        // Changing data in database using productDTO

        return "Product changed";
    }

    @PostMapping("products/delete/{id}")
    public String deleteProduct(@PathVariable("id") String id){
        Product checkProduct = productRepository.getById(id);
        if (checkProduct == null){
            return "None";
        }
        productRepository.deleteProductById(id);
        checkProduct = productRepository.getById(id);
        if (checkProduct == null){
            return "Success";
        }
        return "None";
    }
}

